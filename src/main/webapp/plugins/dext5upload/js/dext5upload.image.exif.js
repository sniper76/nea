var ExifRestorer=function(){return{KEY_STR:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode64:function(c){var a="",b,d,e="",g,f,h="",k=0;do b=c[k++],d=c[k++],e=c[k++],g=b>>2,b=(b&3)<<4|d>>4,f=(d&15)<<2|e>>6,h=e&63,isNaN(d)?f=h=64:isNaN(e)&&(h=64),a=a+this.KEY_STR.charAt(g)+this.KEY_STR.charAt(b)+this.KEY_STR.charAt(f)+this.KEY_STR.charAt(h);while(k<c.length);return a},restore:function(c,a){var b=null;try{if(!c.match("data:image/jpeg;base64,"))return a;var d=this.decode64(c.replace("data:image/jpeg;base64,",
"")),e=this.slice2Segments(d),g=this.exifManipulation(a,e),b=this.encode64(g)}catch(f){}return b},restore2:function(c,a){var b=null;try{var d=this.slice2Segments(c),e=this.exifManipulation(a,d),b=this.encode64(e)}catch(g){}return b},exifManipulation:function(c,a){var b=this.getExifArray(a),b=this.insertExif(c,b);return new Uint8Array(b)},getExifArray:function(c){for(var a,b=0;b<c.length;b++)if(a=c[b],255==a[0]&225==a[1])return a;return[]},insertExif:function(c,a){var b=c.replace("data:image/jpeg;base64,",
""),d=this.decode64(b),e=d.indexOf(255,3),b=d.slice(0,e),d=d.slice(e),b=b.concat(a);return b=b.concat(d)},slice2Segments:function(c){for(var a=0,b=[];!(255==c[a]&218==c[a+1]);){if(255==c[a]&216==c[a+1])a+=2;else{var d=a+(256*c[a+2]+c[a+3])+2,a=c.slice(a,d);b.push(a);a=d}if(a>c.length)break}return b},decode64:function(c){var a,b,d="",e,g="",f=0,h=[];if(/[^A-Za-z0-9\+\/\=]/g.exec(c))return null;c=c.replace(/[^A-Za-z0-9\+\/\=]/g,"");do a=this.KEY_STR.indexOf(c.charAt(f++)),b=this.KEY_STR.indexOf(c.charAt(f++)),
e=this.KEY_STR.indexOf(c.charAt(f++)),g=this.KEY_STR.indexOf(c.charAt(f++)),a=a<<2|b>>4,b=(b&15)<<4|e>>2,d=(e&3)<<6|g,h.push(a),64!=e&&h.push(b),64!=g&&h.push(d);while(f<c.length);return h}}}();
